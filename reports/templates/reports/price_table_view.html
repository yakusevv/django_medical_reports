{% extends 'reports/base_reports.html' %}


{% block content %}
<table class="table table-bordered mt-5" frame="vsides">
  <tr>
      <th class="table-active" colspan="{{ price_groups.count|add:'2'}}">
        {{ object }}
      </th>
  </tr>
  {% for region in object.region_set.all %}
  <tr>
    <th class="table-primary"> {{ region }} </th>
    <td class="table-primary"> Tariffs </td>
    {% for price_group in price_groups %}
      <td class="table-primary"> {{ price_group }} </td>
    {% endfor %}
    {% for district in region.district_set.all %}
    <tr>
      <th rowspan="5" style="width: 30%">
        {{ district }}
        <p style="font-weight: lighter; font-size: 15px;">
          {% for city in district.city_set.all %}
            {% if not forloop.last %}
              {{ city }},
            {% else %}
              {{ city }}
            {% endif %}
            {% if forloop.counter|divisibleby:4 %}
            <br>
            {% endif %}
          {% endfor %}
        </p>
      </th>
        {% for type_of_visit in types_of_visit %}
          <td style="width: 20%">
            {{ type_of_visit.name }}
          </td>
          {% for price_group in price_groups %}
            <td>
            {% for tariff in district.tariff_set.all %}
              {% if tariff.price_group == price_group %}
                {% for visit_price in tariff.visittariff_set.all %}
                  {% if visit_price.type_of_visit == type_of_visit %}
                    {{ visit_price.price }}
                  {% endif %}
                {% endfor %}
              {% endif %}
            {% endfor %}
          {% endfor %}
            </td>
    </tr>
        {% endfor %}
    {% endfor %}
  {% endfor %}

</table>
<table class='table-sm'>
  <tr class='table-primary'>
    <th> Service </th>
    <th> Price </th>
  </tr>
  {% for service in object.services.all %}
    {% if not service.type_of_visit %}
    <tr>
      <td>{{service.name }}</td>
      <td>{{ service.price }}</td>
    </tr>
    {% endif %}
  {% endfor %}
</table>



{% endblock %}
